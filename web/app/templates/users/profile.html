{% extends "base.html" %}

{% set profile_navigation_bar = [
        (url_for('users.profile'), 'social', '<i class="material-icons">home</i>', 'Social'),
        (url_for('users.change_password'), 'change_password', '<i class="material-icons">security</i>', 'Change Password'),
] -%}

{% include "_modules.html" %}

{% set main_page = "profile" %}

{% macro show_provider_button(provider_id, display_name, conn, show_update_form=True) %}
    <td>
        {{ display_name }}
    </td>
    <td>
        {% if conn %}
            {#            <form action="{{ url_for('social.remove_connection', provider_id=conn.provider_id, provider_user_id=conn.provider_user_id) }}?__METHOD_OVERRIDE__=DELETE"#}
            {#                  method="POST" class="pull-right remove-connection">#}
            {#                <button type="submit" class="ui button {{ provider_id }}"><i class="{{ provider_id }} icon"></i>#}
            {#                    Remove {{ display_name }} Connection#}
            {#                </button>#}
            {#            </form>#}
        {% else %}
            <div class="control-group">
                <a href="{{ url_for(provider_id+'.login') }}" type="submit" class="ui button {{ provider_id }}"><i
                        class="{{ provider_id }} icon"></i>
                    Connect with {{ display_name }}</a>
            </div>
        {% endif %}
    </td>
{% endmacro %}

{% block content %}
    {% from "security/_macros.html" import render_field_with_errors, render_field %}
    {% include "security/_messages.html" %}
    {% if current_user.has_autogenerated_password %}
        <div class="sixteen wide column">
            <div class="ui warning message">
                <i class="close icon"></i>
                <div class="header">
                    Warning!
                </div>
                You have an auto generated password. We recommend you to change
                it {{ url_for('users.change_password') }}.
            </div>
        </div>
    {% endif %}
    <div class="sixteen wide column">
        <h2><img class="ui avatar image" src="{{ current_user.avatar }}"/> Your Profile</h2>

        <div class="page-header">
            <p>Hello, {{ current_user.email }}!</p>
        </div>
    </div>

    <div class="four wide column">
        <div class="ui vertical pointing menu">
            {% for href, id, icon, text in profile_navigation_bar %}
                <a class="item {% if id == active_page %}active{% endif %}"
                   href="{{ href|e }}">{{ icon|safe }} {{ text }}</a>
            {% endfor %}
        </div>
    </div>
    <div class="twelve wide stretched column">
        <div class="ui segment">
            {% block main_profile %}

            {% endblock %}
        </div>
    </div>

{% endblock %}
