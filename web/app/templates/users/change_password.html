{% from "security/_macros.html" import render_field_with_errors, render_field %}
{% include "security/_messages.html" %}

{% extends "users/profile.html" %}

{% set active_page = "change_password" %}

{% block main_profile %}
    <h3>Change password for {{ current_user.email }}</h3>

    {% if current_user.has_autogenerated_password %}
        <form class="ui form" action="{{ url_for('users.change_password') }}"
              method="POST" name="change_password_form">
            {{ change_social_password_form.hidden_tag() }}
            {{ render_field_with_errors(change_social_password_form.password, "form-control") }}
            {{ render_field_with_errors(change_social_password_form.confirm, "form-control") }}
            <button type="submit" class="ui button primary">Change password</button>
        </form>
    {% else %}

        <form class="ui form" action="{{ url_for('users.change_password') }}" method="POST" name="change_password_form">
            {{ change_password_form.hidden_tag() }}
            {{ render_field_with_errors(change_password_form.password, "form-control") }}
            {{ render_field_with_errors(change_password_form.new_password, "form-control") }}
            {{ render_field_with_errors(change_password_form.new_password_confirm, "form-control") }}
            {{ render_field(change_password_form.submit, "ui button primary") }}
        </form>

    {% endif %}

{% endblock %}
